os: linux
dist: xenial
language: go
install:
  - curl -LO https://github.com/gohugoio/hugo/releases/download/v0.74.1/hugo_0.74.1_Linux-64bit.deb
  - sudo apt install hugo_extended_0.74.1_Linux-64bit.deb
script:
  - git submodule update --init
  - git submodule update --remote --merge
  - hugo -d ../generated
  
deploy:
  provider: pages:git
  token: $GITHUB_TOKEN
  edge: true # opt in to dpl v2
  cleanup: true
  strategy: git
  keep_history: true
  local_dir: ../generated

  on:
    branch: master